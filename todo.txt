todo for next release (v55):
- escape timer based on new timings
- auto-save before escape
- new option for MB fight (to become new default): skip cutscenes + MB3
- new quality-of-life preset "Default":
  - three presets: Off, Default, and Max.
  - Default will have everything except not the short MB fight (only skip cutscenes + MB3)

priority:
- gmode-immobile logic
- add vertical gravity jumps to logic
- add pages for tech, strats, rooms.
- logic simulator
- credits
- proper front page
- music options: vanilla, area-themed, or none
- sprite customization (?),


later:
- fix Lower Norfair Farming Room farm
- show seed hash in main menu (to help in race setup to make sure everyone is using the same seed)
- fix problem with disappearing typewriter text when pausing as escape sequence starts
- redo disable_walljump patch to disable the wall jump only, not disable wall-jump check (which breaks X-ray climb setups)
- add tech for underwater single-sided wall-jumping (UWU)
  - limit to climbs of ~2 tiles
  - require HiJump
  - require SpaceJump for breaking the water
  - put in Insane tier
- fix map tile for phantoon with objectives other than bosses (remove item dot).
- Add override for Tourian Hopper run under strat from left to top (imyt strat)
- add a tip that you can share a seed using the URL.
- add ability to "select" through different areas in pause menu map (check out what Map Overhaul did).
- logic: ice moonfall (in dachora room)
- make graph traversals faster by using previous step for initial local states (probably not worth it?):
  - we'd have to do a full graph traversal to get spoiler route as a separate step, to avoid getting weird long paths
- in sm-json-data: add logical requirement for refills
  - use this for strats that enter G-mode in a room with a refill (or the Ship), use it, and then go back out still in G-mode?
- replace Botwoon Hallway portion of Toilet level data with something more neutral
   - also remove the enemies from the Botwoon Hallway part
- fix gray door after mother brain when entering baby kraid (& metal pirates, boss rooms, etc.?)
- add patch for handling crashes? (to display the stack & registers)
- if possible, debug crash in Mt. Everest from Scottycro42 (https://clips.twitch.tv/DarlingSavageDogeMcaT-zgV9PF33MiawTpL2)
- oats seed Apr 1:
 - main street shinespark energy
 - kronic boost heatframes
 - metal pirates hitbox doesn't need plasma
- take double-hits into account correctly with reserve energy.
- use Fix Scroll Offsets from practice hack
- check if pants room internal door connects correctly in logic
- fix apparent bug with Forced mode which is adding an extra wasted tier that never gets used (but just slows things down a bit)
- add option (enabled on Challenge) to not treat tanks as filler items anymore after giving Varia (including the step where giving Varia)
- (probably bad idea:) add third option for filler items: "After First"
  - reorganize UI to only show this option for Supers, PowerBombs, ETanks, and Reserve Tanks.


- add patch to be able to bind other buttons to angle up/down
- spoiler visualizer improvements:
  - refinements
    - show room if some node in room is bireachable (not only on the way to items)
    - show faded room if no node in the room is bireachable but some node is one-way-reachable?
    - show faded item if some node in the room is reachable but the item itself is not (or is only one-way reachable)
    - show instructions/tips when first opening
      - then we can replace "Spoiler Info" section on seed page with just a single big button
    - make the fog more crisp
    - make it so you can click on an item in the step panel and it will show the route to the item
    - show the route info in a separate panel below the step panel
  - bugs to fix:
    - mouse-over item info sometimes gets covered up by fog
    - mouse-over room info doesn't work after panning (have to reload)
  - eventually integrate with logic pages once those are implemented:
    - double-clicking on room can go to our room page (instead of to wiki)
    - clicking on a strat (in route info) goes to strat page
  - other possible improvements:
    - mouse-over a room shows an image of the room
      - or, there's a toggle to switch from map view to image view.
    - add controls to properly zoom
    - once available, use junction bounding boxes to plot the paths more accurately, and avoid having lines going outside of the room's tiles
    - show flags in the steps too (e.g. bosses) and be able to click on them too to show the route
      - come up with new icons for these: G4 bosses, minibosses, golden torizo, shaktool, maridia tube, acid chozo statue, mother brain
      - (mother brain needs to be added to the logic as a flag)
- separate animation for screw attack without space jump (like in SMZ3?)
- fix panic that is occasionally happening:
  thread 'actix-rt|system:0|arbiter:0' panicked at 'assertion failed: num_key_items_to_place >= 1', src/randomize.rs:671:9
- find some way to have forced mode take into account difficulty of defeating bosses (and other flags)
  - for each flag, identify its tier using just the flag edge (not redoing a full graph traversal)
  - then for the item placement, have the graph traversal treat that flag not as free but as whatever difficulty it was.
- consider putting back the save confirmation.
- fix graphics in door transitions?
- fix (sometimes?) glitched right door in GT. X-Ray showed a plasma beam inside it
- find some way to make it more obvious when you wake Zebes?
  - maybe open/closed eye icon next to defeated bosses marked in pause menu?
- fix game crash that can happen when quick-reloading in death animation
- add count of how many times each tech is used
- make tech dependencies also look at "obstacles"
- consider splitting up Streamlined escape into 3 separate QoL options (removing the need for a footnote to explain it)
- add crystal flash to logic when needed for energy
  - do we need sm-json-data to mark nodes which are unsafe for crystal flashing?
- consider adding a mode that can require leaps-of-faith
- speed up parts of MB: where Big Boy is latched on to MB, and death animation (shouldn't affect stand-up)
- add more farms to logic
- adjust elevator heatFrames when fast elevators enabled
- make quick reload work while in pause menu
- make quick reload in save room to go back to previous save? (what about in Landing Site?)
- add caution tape to dangerous doors?
- fix camera in bowling alley (for CF grapple clip)
- figure out glitch where sometimes bottom pixel of HUD is messed up, scrolling with the camera
  - zsnes 1.36: map-rando-5jGQIBX24w4DVQjZ5as5zQ.sfc
- add reverse botwoon logic from osse's PR
- refine cross room shinesparks:
    - excessShinesparkFrames (reverse)
    - slopes
- controller config special settings (moonwalk) customization
- tweak balancing:
  - give a little more weight to save coverage
  - give a little less weight to hallway penalty
- consider overhauling how cross-room logic is encoded:
  - canComeInCharged should be in a special part of the "node" (symmetric to "canLeaveCharged"), not in "links"
  - same thing for adjacentRunway
  - since "can" sounds like a tech, maybe we should rename these "enterCharged", "enterWithRunway", etc. (later we can have
    "enterWithSpeedball" and other things), and symmetrically, "exitCharged", "exitWithSpeedball", etc.
  - This is cleaner, reduces need for preprocessing, and would cut out the possibility of expressing invalid things
    like requiring multiple adjacentRunway from different nodes in the same strat.
- consider indicating heated rooms & fully immersed rooms on map?
- improve slow-progression logic: allow item progression by unlocking way back
  - don't immediately place filler items at one-way reachable locations
  - instead check that when a key item is placed at a previously one-way-reachable location, the item would not have provided
    a way back at an earlier step?
- fix spoiler log for reverse paths using shinesparks
- fix bug where controls are locked when dying from enemy during elevator
  - also from quick reloading during elevator
- fix bug where suit color does not change when changing suits while taking damage (e.g. lava dive)?
- fix bug where music is wrong after quick reload (even after going to next room).
- clean up the web service, to reduce the amount of boilerplate plumbing settings around.
- add front page to website
- explain about doors being turned blue?
- increase amount of rolling saves?
- figure out why some rooms are dark (some FX other than palette FX?)
- add back palette FX glows using correct palettes.
- fix palette in Crocomire cutscene when wall collapses
- if feasible, mark collected items somehow (preferably as dark gray dots, otherwise as blank)
- During escape, block backward path using room setup ASM instead of door ASM (so it can still work after leaving room another way)
- make separate option for patching out major glitches?
  - include GT code, Spacetime beam (currently patched out)
  - make OOB cause instant death?
  - others
- area-themed palettes:
  - remove or fix glows that are wrong color (e.g. Wrecked Ship?)
- Add way to export settings from seed page (and export/import on main page).
- With a future ML model, treat Mother Brain room as 0-way (instead of one-way) to ensure items, maps, etc.
  cannot be locked behind Mother Brain.
    - Improve map connectedness so it's less likely for a large area to have only one exit.
    - Spread out placement of single-tile, single-door rooms to help balancing of saves & refills.
- at end of randomization, make sure G4 bosses are reachable (to guard against a case like Phantoon being locked behind
  Bowling, or a G4 boss locked behind Mother Brain).
- Handle shinespark_frames=0 correctly (don't require 29 energy)
- Better validation/error-handling of web service
  - push more validation into client
- Make big button for spoiler info.
  - put instructions in the spoiler page itself instead of on the seed page
- Add note to strat in Post-Crocomire farming room to get to top-left with HiJump
  (run on platform enemy and jump)
- Use separate worker pool to run randomization (to avoid blocking web requests)
- Rust cleanup:
    - Use `serde_json` instead of `json` crate for loading sm-json-data.
    - Clean up error handling: get rid of a bunch of remaining unwrap()'s, etc.
- on web site, clarify some things about how logic works, e.g.
    - hellruns may be required if canHeatRun tech is enabled.
- Make Gravity-only Samus palette different from Gravity+Varia.
    - Figure out how this can work with custom sprites.
- Consider rejecting cases where the set of bireachable item locations grows too slow or too fast.
- fix color of reserve tank energy in equipment menu (got messed up by colored arrows)
- move GFX colors:
  - Morph Ball room (blue brinstar), tileset 7:
    - [0x31, 0x32, 0x33] -> [0x38, 0x39, 0x3A]
- make the pause map tiles align with the grid
- fix tiny bug: when bottom-left door of landing site is an area transition, the arrow shows up from the beginning
  of the game (due to running the door ASM while loading the game)
- organize tech on website.
- fix internal checksum in output ROM
- add README
- fix suit graphics not showing after getting suit (consequence of skipping animation)?

maybe someday?:
- show whole Zebes map in pause menu?
  - instead of blue/pink, use area-themed colors (with light/dark to mark explored/unexplored)
  - probably difficult, but maybe possible?
  - play subversion and then chat with amoeba to get more ideas
- change how item dots appear once collected?
  - make them disappear or turn gray?
  - consider using dynamic tiles or sprites:
     - we would need to limit how many can appear on the pause screen at the same time.
     - amoeba apparently found there was more room for tiles than sprites?
  - we need this to show up on HUD as well as pause map
- minimizer mode? (select rooms to include randomly, hand-picked, and/or user-selected)
- make map rando for other hacks (e.g. project base, subversion?)
  - would be a lot of work. we could invite others to help implement the logic
- multitroid support


rejected ideas (probably):
- set boss flag immediately when boss dies.
- balance boss distribution (one boss per area, corresponding to vanilla?)
- check if map reload is messing up timing at start of rooms (e.g. Beta Power Bombs)
  - or more likely music reload is a factor. Can we artificially trigger reload in Morph Ball room or do something else
  to fix the timing with the hoppers?
- consider moving the MB barriers to the right one tile (or two?), to make them interfere less with ice zeb skip.
- have forced mode take into account return path? (probably a bad idea)
- Remove Crocomire funny map behavior?
- Option for anti-softlock patches (e.g. in Moat, Early Supers, etc.)?
  - disable acid trigger in Leodox room?


notes on tileset palette stuff:
  - tileset table: $8FE6A2  (will need to move to location with more space)
  - tileset pointers: $8FE7A7  (will need to update to point into new tileset table)
  - current tileset (one row of tileset table):
    - $07C0: Tileset tile table pointer
    - $07C3: Tileset tiles pointer
    - $07C6: Tileset palette pointer
  - reference to tileset pointers: $82:DF02 (LDA $E7A7, y)
- tileset data decompressed to RAM:
    - tile table: $7E:A800  (at $82:E856)
       - CRE tile table: $7E:A000  (at $82:E843)
          - from $B9A09D
    - tiles: $7E:2000  (at $82:E42E)
      - VRAM $0000 (at $82:E7B4)
    - palette: $7E:C200  (at $82:E43F)
 - palette FX loading: https://patrickjohnston.org/bank/89#fAB82
- MB lights back on: https://patrickjohnston.org/bank/AD#fF24B

notes on marking elevator tiles:
- boss tile marking: $90:A7E2


title graphics notes:
  - title
     - sprites GFX: $95:80D8 ("Super Metroid" graphics, "Nintendo", etc.):
         - bank pointer to sprite GFX at $8B:9295
         - word pointer to sprite GFX at $8B:9299
         - copied to VRAM $6000..7FFF
     - spritemap: $8C:879D (also $8C:833D but this is unused)?
         - free space at $8C:F760
         - (2-byte) pointer to spritemap: $8B:A0C5
         - Description of spritemap format: $A9:93EE
     - uses screen mode 7 during title
          - only BG layer is BG1 (as always for mode 7).
          - OAM base: VRAM 0xC000  (sprite GFX for "Super Metroid" title)
     - normally mode 1 elsewhere
  - title BG GFX: $94:E000 (0xA6000)
  - title BG tilemap: $96:FC04 (0xB7C04)




Notes on calculating PLM position (and comparing with Samus position):

;    $0AF6: Samus X position (in pixels)
;    $0AFA: Samus Y position (in pixels)
;
;    $1C29: PLM X block (calculated by $84:8290)
;    $1C2B: PLM Y block (calculated by $84:8290)

$84:82AA 8D 2B 1C    STA $1C2B  [$7E:1C2B]
$84:82AD AD 16 42    LDA $4216  [$7E:4216]
$84:82B0 8D 29 1C    STA $1C29  [$7E:1C29]


;;; $BB6B: Pre-instruction - wake PLM if triggered or Samus is within 4 block column below PLM ;;;
{
$84:BB6B 22 90 82 84 JSL $848290[$84:8290]  ; Calculate PLM block co-ordinates
$84:BB6F AD F6 0A    LDA $0AF6  [$7E:0AF6]  ;\
$84:BB72 4A          LSR A                  ;|
$84:BB73 4A          LSR A                  ;|
$84:BB74 4A          LSR A                  ;} If [Samus X block] = [PLM X block]:
$84:BB75 4A          LSR A                  ;|
$84:BB76 CD 29 1C    CMP $1C29  [$7E:1C29]  ;|
$84:BB79 D0 10       BNE $10    [$BB8B]     ;/
$84:BB7B AD FA 0A    LDA $0AFA  [$7E:0AFA]  ;\
$84:BB7E 4A          LSR A                  ;|
$84:BB7F 4A          LSR A                  ;|
$84:BB80 4A          LSR A                  ;|
$84:BB81 4A          LSR A                  ;} If 0 <= [Samus Y block] - [PLM Y block] < 5: go to BRANCH_TRIGGERED
$84:BB82 38          SEC                    ;|
$84:BB83 ED 2B 1C    SBC $1C2B  [$7E:1C2B]  ;|
$84:BB86 C9 05 00    CMP #$0005             ;|
$84:BB89 90 05       BCC $05    [$BB90]     ;/

$84:BB8B BD 77 1D    LDA $1D77,x[$7E:1DC5]  ;\
$84:BB8E F0 13       BEQ $13    [$BBA3]     ;} If not triggered: return

; BRANCH_TRIGGERED
$84:BB90 FE 27 1D    INC $1D27,x[$7E:1D75]  ;\
$84:BB93 FE 27 1D    INC $1D27,x[$7E:1D75]  ;} PLM instruction list pointer += 2
$84:BB96 A9 01 00    LDA #$0001             ;\
$84:BB99 9F 1C DE 7E STA $7EDE1C,x[$7E:DE6A];} PLM instruction timer = 1
$84:BB9D A9 A3 BB    LDA #$BBA3             ;\
$84:BBA0 9D D7 1C    STA $1CD7,x[$7E:1D25]  ;} PLM pre-instruction = RTS

$84:BBA3 60          RTS



Mini-map notes:
- HUD GFX:
    - ROM $9A:B200
- HUD Tilemap:
    - RAM $7E:C608
    - VRAM $5820 (BG3)


Notes on game-over/loading:
- In file select, some loading happens starting at $81AD17

Notes on usage of area ($079F and $7E:D918):


Map-related usages: ---------------------------------------------------
Bank $80.asm:$80:85A7 AE 9F 07    LDX $079F  [$7E:079F]
Bank $80.asm:$80:858F AD 9F 07    LDA $079F  [$7E:079F]
	;;; $858C: Load mirror of current area's map explored ;;;

Bank $80.asm:$80:85C9 AD 9F 07    LDA $079F  [$7E:079F]
Bank $80.asm:$80:85E6 AE 9F 07    LDX $079F  [$7E:079F]
	;;; $85C6: Mirror current area's map explored ;;;

Bank $82.asm:$82:941B AD 9F 07    LDA $079F  [$7E:079F]
;;; $93C3: Updates the area and map in the map screen ;;;

Bank $82.asm:$82:9440 AD 9F 07    LDA $079F  [$7E:079F]
Bank $82.asm:$82:9475 AE 9F 07    LDX $079F  [$7E:079F]
;;; $943D:  ;;;
   (subroutine in $93C3: Updates the area and map in the map screen ;;;)

Bank $82.asm:$82:952D AD 9F 07    LDA $079F  [$7E:079F]
Bank $82.asm:$82:9562 AE 9F 07    LDX $079F  [$7E:079F]
;;; $9517: Draw room select map ;;;

Bank $82.asm:$82:962B AD 9F 07    LDA $079F  [$7E:079F]
;;; $9628:  ;;;
		(???)

Bank $82.asm:$82:9ED5 AD 9F 07    LDA $079F  [$7E:079F]
Bank $82.asm:$82:9F01 AD 9F 07    LDA $079F  [$7E:079F]
;;; $9EC4:  ;;;
		(???)

Bank $82.asm:$82:B6BC AD 9F 07    LDA $079F  [$7E:079F]
;;; $B672: Draw map icons ;;;

Bank $82.asm:$82:B71C AD 9F 07    LDA $079F  [$7E:079F]  ;|
Bank $82.asm:$82:B777 AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $B6DD:  ;;;
	(??? - related to map icons)

Bank $82.asm:$82:B79C AD 9F 07    LDA $079F  [$7E:079F]
Bank $82.asm:$82:B7BB AD 9F 07    LDA $079F  [$7E:079F]
;;; $B798: Draw save station map icon ;;;

Bank $82.asm:$82:B80E AD 9F 07    LDA $079F  [$7E:079F]
;;; $B805: Draw simple map icon ;;;
; Icons. Missile, energy, map, and debug save. X = type, A = graphic

Bank $82.asm:$82:B896 AE 9F 07    LDX $079F  [$7E:079F]
Bank $82.asm:$82:B8A2 AD 9F 07    LDA $079F  [$7E:079F]
;;; $B892: Display map boss icons ;;;

Bank $82.asm:$82:BB3A AE 9F 07    LDX $079F  [$7E:079F]  ;\
Bank $82.asm:$82:BB46 AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $BB30: Display map elevator destinations ;;;
		
Bank $90.asm:$90:A9BE AD 9F 07    LDA $079F  [$7E:079F]  ;|
;;; $A91B: Update mini-map ;;;

Bank $90.asm:$90:AA73 AD 9F 07    LDA $079F  [$7E:079F]  ;\
Bank $90.asm:$90:AA78 6D 9F 07    ADC $079F  [$7E:079F]  ;|
;;; $AA43: Update HUD mini-map tilemap ;;;

Bank $84.asm:$84:8C91 AE 9F 07    LDX $079F  [$7E:079F]
;;; $8C8F: Instruction - activate map station ;;;

Bank $8F.asm:$8F:C90C AE 9F 07    LDX $079F  [$7E:079F]
;;; $C90A: Setup ASM: set collected map ;;;
; Room $DAAE. Tourian -> Crateria 
		(Tourian first room)

Bank $84.asm:$84:B19C AE 9F 07    LDX $079F  [$7E:079F]  ;\
;;; $B18B: Setup - PLM $B6D3 (map station) ;;;
		(checking if collected current area map)

Save/load and file menu usages: ----------------------------------------
Bank $82.asm:$82:DE86 8D 9F 07    STA $079F  [$7E:079F]  ;/
;;; $DE6F: Load room header ;;;

Bank $80.asm:$80:C443 AD 9F 07    LDA $079F  [$7E:079F]
Bank $80.asm:$80:C4AC 8D 9F 07    STA $079F  [$7E:079F]
	;;; $C437: Load from load station ;;;
	(first usage to get index of save station, 
	second to set area from room header)

Bank $81.asm:$81:8023 AD 9F 07    LDA $079F  [$7E:079F]  ;\
Bank $81.asm:$81:8043 AD 9F 07    LDA $079F  [$7E:079F]  ;\
	;;; $8000: Save to SRAM ;;;
	(hijacked by Scyzer's patch)

Bank $81.asm:$81:80F4 8D 9F 07    STA $079F  [$7E:079F]  ;} Area index = [SRAM area index]
Bank $81.asm:$81:8123 8D 9F 07    STA $079F  [$7E:079F]  ; Region = Crateria
	;;; $8085: Load from SRAM ;;;
	(hijacked by Scyzer's patch)

Bank $81.asm:$81:9CEB 8D 9F 07    STA $079F  [$7E:079F]
;;; $9C9E: Save game menu - index 19h:  ;;;

Bank $81.asm:$81:A395 AD 9F 07    LDA $079F  [$7E:079F]
Bank $81.asm:$81:A3B0 EC 9F 07    CPX $079F  [$7E:079F]
;;; $A37C: File select map - index 1 ;;;

Bank $81.asm:$81:A57D AC 9F 07    LDY $079F  [$7E:079F]
;;; $A578: File select map - index 12h ;;;

Bank $81.asm:$81:A587 AC 9F 07    LDY $079F  [$7E:079F]
;;; $A582: File select map - index 3: Load area select background tilemap ;;;


Bank $81.asm:$81:A8B5 8D 9F 07    STA $079F  [$7E:079F]
Bank $81.asm:$81:A8CA 8D 9F 07    STA $079F  [$7E:079F]
Bank $81.asm:$81:A8E2 AD 9F 07    LDA $079F  [$7E:079F]
;;; $A8A9:  ;;;
	(???)

Bank $81.asm:$81:AB1A AD 9F 07    LDA $079F  [$7E:079F]
;;; $AAAC: File select map - index 7 ;;;

Bank $81.asm:$81:AD3C 8D 9F 07    STA $079F  [$7E:079F]
;;; $AD17: File select map - index 9 ;;;

Bank $81.asm:$81:ADC0 AD 9F 07    LDA $079F  [$7E:079F]
Bank $81.asm:$81:ADF2 AD 9F 07    LDA $079F  [$7E:079F]
Bank $81.asm:$81:AE05 AD 9F 07    LDA $079F  [$7E:079F]
;;; $AD7F: File select map - index Ah: room select map ;;;

Bank $81.asm:$81:AE6A AD 9F 07    LDA $079F  [$7E:079F]
;;; $AE13:  ;;;
	(???)

Bank $81.asm:$81:AFE6 AE 9F 07    LDX $079F  [$7E:079F]
Bank $81.asm:$81:AFEC AC 9F 07    LDY $079F  [$7E:079F]
;;; $AFD3: File select map - index 10h ;;;


Bank $81.asm:$81:B005 AD 9F 07    LDA $079F  [$7E:079F]
;;; $AFF6: File select map - index 14h ;;;


Bank $82.asm:$82:8032 9C 9F 07    STZ $079F  [$7E:079F]  ; Area = Crateria
Bank $82.asm:$82:8044 8D 9F 07    STA $079F  [$7E:079F]  ;} Area = Ceres
;;; $8000: Game state 6/1Fh/28h (loading game data / set up new game / transition to demo) ;;;

Bank $82.asm:$82:86EC 8D 9F 07    STA $079F  [$8F:079F]  ;|
;;; $8679: Load demo room data ;;;


Bank $8B.asm:$8B:A39C 9C 9F 07    STZ $079F  [$7E:079F]  ; Area index = Crateria
;;; $A395: Cinematic function - intro - initial ;;;

Bank $8B.asm:$8B:C10D 8D 9F 07    STA $079F  [$7E:079F]
;;; $C100:  ;;;
		(set area to Ceres when setting up new game)


Other usages: ---------------------------------------------------
Bank $80.asm:$80:81AE AE 9F 07    LDX $079F  [$7E:079F]
	;;; $81A6: Set boss bits in A for current area ;;;

Bank $80.asm:$80:81CA AE 9F 07    LDX $079F  [$7E:079F]
	;;; $81C0: Unused. Clear boss bits in A for current area ;;;

Bank $80.asm:$80:81E4 AE 9F 07    LDX $079F  [$7E:079F]
	;;; $81DC: Checks if the boss bits for the current area match any bits in A ;;;

Bank $80.asm:$80:CD0D AD 9F 07    LDA $079F  [$7E:079F]  ;\
	;;; $CD07: Set elevators as used ;;;

Bank $82.asm:$82:B7D5 AD 9F 07    LDA $079F  [$7E:079F]
;;; $B7D1:  ;;;
; Debug related

Bank $82.asm:$82:B7EF AD 9F 07    LDA $079F  [$7E:079F]
;;; $B7EB:  ;;;
; Debug related

Bank $82.asm:$82:BE5C AD 9F 07    LDA $079F  [$7E:079F]
;;; $BE5A:  ;;;
; So... this routine does some stuff and then crashes?

Bank $82.asm:$82:BEC3 9C 9F 07    STZ $079F  [$7E:079F]
Bank $82.asm:$82:BEC8 AD 9F 07    LDA $079F  [$7E:079F]
Bank $82.asm:$82:BEE0 AE 9F 07    LDX $079F  [$7E:079F]
Bank $82.asm:$82:BEF7 AD 9F 07    LDA $079F  [$7E:079F]
Bank $82.asm:$82:BEFB 8D 9F 07    STA $079F  [$7E:079F]
;;; $BEA3:  ;;;
; So... this routine does some stuff and then crashes as well? Great!


Bank $82.asm:$82:E833 AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $E7D3: Load level data, CRE, tile table, scroll data, create PLMs and execute door ASM and room setup ASM ;;;
	(just checking if Ceres)

Bank $82.asm:$82:EADB AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $EA73: Load level, scroll and CRE data ;;;
	(just checking if Ceres)

Bank $84.asm:$84:8D16 AD 9F 07    LDA $079F  [$7E:079F]  ;|
;;; $8CF1: Instruction - activate save station and go to [[Y]] if [save confirmation selection] = no ;;;

Bank $84.asm:$84:B7C3 AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $B7C3: Setup - PLM $B7EB (enable sounds in 20h frames, or F0h frames if on Ceres) ;;;
		(just checking if Ceres)

Bank $86.asm:$86:932F AD 9F 07    LDA $079F  [$7E:079F]
;;; $932F:  ;;;
		(something to do with Ridley's fireball -- checking if in Norfair or Tourian?)

Bank $86.asm:$86:9451 AC 9F 07    LDY $079F  [$7E:079F]
;;; $9442: Unused ;;;

Bank $86.asm:$86:AB96 AD 9F 07    LDA $079F  [$7E:079F]
;;; $AB8A: Instruction ;;;
		(checking if Crateria -- something to do with enemy drops)

Bank $89.asm:$89:AC62 AD 9F 07    LDA $079F  [$7E:079F]  ;\
Bank $89.asm:$89:AC98 AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $AB82: Load FX header ;;;

Bank $8D.asm:$8D:EEC6 AE 9F 07    LDX $079F  [$7E:079F]  ;|
;;; $EEC5: Pre-instruction - delete palette FX object if area mini-boss is dead ;;;

Bank $8D.asm:$8D:F731 AE 9F 07    LDX $079F  [$7E:079F]  ;|
;;; $F730: Setup - palette FX object $F779 (Brinstar 8) ;;;
		(related to Spore Spawn)

Bank $90.asm:$90:EA57 AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $EA45: Pause check ;;;
		(just checking if Ceres)

Bank $90.asm:$90:ED88 AD 9F 07    LDA $079F  [$7E:079F]
;;; $ED88: Footstep graphics ;;;
; Water splashing in Maridia and Crateria, dust if speedrunning.
; Only works on certain frames, assumed to be walking/running


Bank $91.asm:$91:850F AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $84D5: Pause/terminate/reset demo recorder ;;;
; Controller 2 X pauses/terminates demo recorder
; Controller 2 A resets demo recorder

Bank $91.asm:$91:CF40 AD 9F 07    LDA $079F  [$7E:079F]
;;; $CF3E:  ;;;
		(seems related to respawning speedboost block which only works in Brinstar, e.g. in dachora room)

Bank $91.asm:$91:E097 AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $E00D: Initialise Samus ;;;
; Executed when loading demo or starting at Ceres/Zebes
		(just checking if Ceres)

Bank $91.asm:$91:F0A5 AD 9F 07    LDA $079F  [$7E:079F]
;;; $F0A5: Handle landing graphics ;;;

Bank $94.asm:$94:8E83 AD 9F 07    LDA $079F  [$7E:079F]
;;; $8E83: Samus block collision reaction - spike block - BTS 0 (generic spike) ;;;
; Unless already hurt, deal 60 damage (environmental) to Samus, unless in WS and Phantoon is alive


Bank $94.asm:$94:908C AD 9F 07    LDA $079F  [$7E:079F]  ;|
;;; $906F: Samus block collision reaction - horizontal - special air ;;;
; Area dependant BTS

Bank $94.asm:$94:90BA AD 9F 07    LDA $079F  [$7E:079F]
;;; $909D: Samus block collision reaction - vertical - special air ;;;
		(Area dependant BTS)

Bank $94.asm:$94:90EC AD 9F 07    LDA $079F  [$7E:079F]
;;; $90CB: Samus block collision reaction - horizontal - special block ;;;
; Check BTS.
; If positive, make a PLM from the table at 9139,X (X=2*BTS, max BTS is 4F).
; If negative, make a region-indexed PLM (91D9 + 20*Area + 2*BTS, max BTS is 0F).
; If PLM fails to be made, JMP $8F49 (normal solid)

Bank $94.asm:$94:9123 AD 9F 07    LDA $079F  [$7E:079F]
;;; $9102: Samus block collision reaction - vertical - special block ;;;
; Check BTS.
; If positive, make a PLM from the table at 9139,X (X=2*BTS, max BTS is 4F).
; If negative, make a region-indexed PLM (91D9 + 20*Area + 2*BTS, max BTS is 0F).
; If PLM fails to be made, JMP $8F82 (normal solid)

Bank $94.asm:$94:98EA AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $98EA: Block inside reaction - special air - BTS 8 (Wrecked Ship treadmill - rightwards) ;;;
		(checking if Wrecked Ship)

Bank $94.asm:$94:9910 AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $9910: Block inside reaction - special air - BTS 9 (Wrecked Ship treadmill - leftwards) ;;;

Bank $94.asm:$94:9B2F AD 9F 07    LDA $079F  [$7E:079F]  ;|
;;; $9B16: Block inside reaction - special air ;;;

Bank $94.asm:$94:9D90 AD 9F 07    LDA $079F  [$7F:079F]
;;; $9D71: Block bombed reaction - special block ;;;
; Load the BTS into A.
; If negative, AND with #$007F and use to find a region-indexed PLM (94:9DC4 + Region * 10 + BTS * 2).
; If positive, use as an index for 94:9DA4,X to make a PLM.
; Either way, clear V, SEC, and RTS

Bank $94.asm:$94:9E92 AD 9F 07    LDA $079F  [$7E:079F]
;;; $9E73: Block shot/bombed/grappled reaction - shootable block ;;;
; Check BTS. If positive, create PLM from main table (94:9EA6 + BTS*2, 'max' BTS of 50).
; If negative, create region-indexed PLM (94:9F46 + 10*region + BTS*2, 'max' BTS of 10).
; Either way, clear V, SEC, RTS.

Bank $A0.asm:$A0:A7E7 AD 9F 07    LDA $079F  [$7E:079F]  ;\
Bank $A0.asm:$A0:A88D AD 9F 07    LDA $079F  [$7E:079F]  ;\
;;; $A6DE: Handles beam damage, freezing, and sound ;;;
		(checks if area is Norfair, for some reason freezing enemies works differently there?)

Bank $A4.asm:$A4:8A73 AE 9F 07    LDX $079F  [$7E:079F]
;;; $8A5A: Initialisation AI - enemy $DDBF (Crocomire) ;;;
		(checks area mini-boss bit to see if Crocomire is already dead)

Bank $A4.asm:$A4:9B90 AE 9F 07    LDX $079F  [$7E:079F]
;;; $9B86:  ;;;
		(set area mini-boss bit when Crocomire is killed)

Bank $A4.asm:$A4:F67A AE 9F 07    LDX $079F  [$7E:079F]
;;; $F67A: Initialisation AI - enemy $DDFF (Crocomire's tongue) ;;;
		(checks area mini-boss bit to see if Crocomire is already dead)

Bank $A5.asm:$A5:92D4 AE 9F 07    LDX $079F  [$7E:079F]
;;; $92AB:  ;;;
		(set area boss bit when Draygon is killed)

Bank $A5.asm:$A5:EA8F AE 9F 07    LDX $079F  [$7E:079F]  ;\
;;; $EA2A: Initialisation AI - enemy $DF3F/$DF7F (Spore Spawn) ;;;
		(check area mini-boss bit to see if Spore Spawn is already dead)

Bank $A5.asm:$A5:EE30 AE 9F 07    LDX $079F  [$7E:079F]
;;; $EDF3: Spore Spawn reaction ;;;
		(set area mini-boss bit when Spore Spawn is killed)

Bank $A6.asm:$A6:A0F5 AE 9F 07    LDX $079F  [$7E:079F]
;;; $A0F5..EFB0: Ridley ;;;
;;; $A0F5: Initialisation AI - enemy $E13F/$E17F (Ridley) ;;;
		(check area boss bit to see if Ridley is dead)

Bank $A6.asm:$A6:A15C AD 9F 07    LDA $079F  [$7E:079F]
Bank $A6.asm:$A6:A369 AC 9F 07    LDY $079F  [$7E:079F]
Bank $A6.asm:$A6:A424 AD 9F 07    LDA $079F  [$7E:079F]
Bank $A6.asm:$A6:A469 AD 9F 07    LDA $079F  [$7E:079F]
Bank $A6.asm:$A6:A478 AD 9F 07    LDA $079F  [$7E:079F]
;;; $A0F5..EFB0: Ridley ;;;
		(check if area is Norfair)

Bank $A6.asm:$A6:C369 AD 9F 07    LDA $079F  [$7E:079F]
;;; $C2B1: Handle typewriter text ;;;
		(check if area is Ceres)

Bank $A6.asm:$A6:D914 AD 9F 07    LDA $079F  [$7E:079F]
Bank $A6.asm:$A6:D93B AD 9F 07    LDA $079F  [$7E:079F]
;;; $D914:  ;;;
; Cause room shaking, only happens in Ceres. Has unreachable code for Norfair room shaking

Bank $A6.asm:$A6:DF8A AD 9F 07    LDA $079F  [$7E:079F]
;;; $DF8A: Enemy shot - enemy $E13F/$E17F (Ridley) ;;;
		(check if area is Norfair)

Bank $A6.asm:$A6:E4D2 AD 9F 07    LDA $079F  [$7E:079F]
;;; $E4D2: Instruction ;;;
; If in Norfair or Samus is below 30 health, go to next instruction. Else go to argument, and set main AI script timer to 8

Bank $A6.asm:$A6:F66B AE 9F 07    LDX $079F  [$7E:079F]  ;\
;;; $F66A: Instruction - go to parameter if area boss is not dead ;;;
		(check if area is boss is dead -- for Ceres Ridley?)

Bank $A7.asm:$A7:A92D AE 9F 07    LDX $079F  [$7E:079F]
;;; $A92C: Check if Kraid has died ;;;

Bank $A7.asm:$A7:C822 AE 9F 07    LDX $079F  [$80:079F]  ;\
;;; $C815: Kraid function - fade in regular background - fade in BG palette 6 ;;;

Bank $A7.asm:$A7:DB7B AE 9F 07    LDX $079F  [$7E:079F]
;;; $DB3D:  ;;;
		(set boss bit when Phantoon killed)

Bank $A8.asm:$A8:CB77 AE 9F 07    LDX $079F  [$7E:079F]  ;\
;;; $CB77: Initialisation AI - enemy $E8FF (Wrecked Ship robot) ;;;

Bank $A8.asm:$A8:D196 AE 9F 07    LDX $079F  [$7E:079F]  ;\
;;; $D192: Enemy shot - enemy $E8FF (Wrecked Ship robot) ;;;

Bank $A8.asm:$A8:E668 AE 9F 07    LDX $079F  [$7E:079F]
;;; $E637: Initialisation AI - enemy $EA3F (Wrecked Ship spark) ;;;

Bank $B4.asm:$B4:942D AD 9F 07    LDA $079F  [$7E:079F]  ;|
;;; $941D: Debug. Draw enemy set name ;;;